<% content_for :title, "Admin - Postal Codes" %>

<div class="admin-container">
  <div class="admin-header">
    <h1>Postal Codes Admin</h1>
    <p class="admin-count">Showing <%= @total_count %> records</p>
  </div>

  <div class="admin-filters">
    <%= form_with url: admin_postal_codes_path, method: :get, local: true, class: "filter-form" do %>
      <div class="filter-group">
        <label for="type">Type</label>
        <select name="type" id="type">
          <option value="">All Types</option>
          <option value="province" <%= "selected" if params[:type] == "province" %>>Province</option>
          <option value="district" <%= "selected" if params[:type] == "district" %>>District</option>
          <option value="commune" <%= "selected" if params[:type] == "commune" %>>Commune</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="province_filter">Province</label>
        <select name="province_filter" id="province_filter">
          <% @provinces.each do |province| %>
            <option value="<%= province %>" <%= "selected" if params[:province_filter] == province %>><%= province %></option>
          <% end %>
        </select>
      </div>

      <div class="filter-group">
        <label for="district_filter">District</label>
        <select name="district_filter" id="district_filter">
          <option value="">All Districts</option>
          <% @districts.each do |district| %>
            <option value="<%= district %>" <%= "selected" if params[:district_filter] == district %>><%= district %></option>
          <% end %>
        </select>
      </div>

      <div class="filter-actions">
        <button type="submit" class="btn btn-primary">Filter</button>
      </div>
    <% end %>
  </div>

  <div class="admin-table-wrapper">
    <table class="admin-table">
      <thead>
        <tr>
          <th>Code</th>
          <th>Postal Code</th>
          <th>Name (EN)</th>
          <th>Name (KM)</th>
          <th>Type</th>
        </tr>
      </thead>
      <tbody>
        <% @postal_codes.each do |pc| %>
          <tr class="<%= pc.location_type %>">
            <td class="code"><%= pc.code %></td>
            <td class="postal-code"><%= pc.postal_code %></td>
            <td><%= pc.name_en %></td>
            <td class="name-km"><%= pc.name_km %></td>
            <td><span class="type-badge <%= pc.location_type %>"><%= pc.location_type %></span></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<style>
  .admin-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .admin-header {
    margin-bottom: 1.5rem;
  }

  .admin-header h1 {
    font-size: 1.75rem;
    color: var(--primary);
    margin-bottom: 0.25rem;
  }

  .admin-count {
    color: var(--text-light);
    font-size: 0.875rem;
  }

  .admin-filters {
    background: var(--white);
    padding: 1rem;
    border-radius: var(--radius-sm);
    margin-bottom: 1rem;
    box-shadow: var(--shadow);
  }

  .filter-form {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: flex-end;
  }

  .filter-group {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .filter-group label {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-light);
    text-transform: uppercase;
  }

  .filter-group select {
    padding: 0.5rem 0.75rem;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    font-family: inherit;
    font-size: 0.875rem;
    min-width: 150px;
  }

  .filter-actions {
    display: flex;
    gap: 0.5rem;
  }

  .btn {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: var(--radius-sm);
    font-family: inherit;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
  }

  .btn-primary {
    background: var(--primary);
    color: var(--white);
  }

  .btn-primary:hover {
    background: var(--primary-dark);
  }

  .admin-table-wrapper {
    background: var(--white);
    border-radius: var(--radius-sm);
    box-shadow: var(--shadow);
    overflow-x: auto;
  }

  .admin-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.875rem;
  }

  .admin-table th {
    background: var(--secondary);
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 600;
    color: var(--text);
    border-bottom: 2px solid var(--border);
  }

  .admin-table td {
    padding: 0.625rem 1rem;
    border-bottom: 1px solid var(--border);
  }

  .admin-table tr:hover {
    background: var(--secondary);
  }

  .admin-table tr.province {
    background: rgba(124, 58, 237, 0.03);
  }

  .admin-table tr.district {
    background: rgba(8, 145, 178, 0.03);
  }

  .admin-table tr.commune {
    background: rgba(22, 163, 74, 0.03);
  }

  .admin-table .code,
  .admin-table .postal-code {
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    font-weight: 500;
  }

  .admin-table .name-km {
    color: var(--text-light);
  }

  .type-badge {
    display: inline-block;
    padding: 0.2rem 0.5rem;
    border-radius: 0.75rem;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
  }

  .type-badge.province {
    background: rgba(124, 58, 237, 0.1);
    color: var(--province);
  }

  .type-badge.district {
    background: rgba(8, 145, 178, 0.1);
    color: var(--district);
  }

  .type-badge.commune {
    background: rgba(22, 163, 74, 0.1);
    color: var(--commune);
  }

  @media (max-width: 768px) {
    .filter-form {
      flex-direction: column;
    }

    .filter-group select {
      width: 100%;
    }

    .admin-table {
      font-size: 0.8rem;
    }

    .admin-table th,
    .admin-table td {
      padding: 0.5rem;
    }
  }
</style>
